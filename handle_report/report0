EXT4-fs (loop0): mounted filesystem without journal. Opts: ,errors=continue
ext4 filesystem being mounted at /syzkaller-testdir4246758361/syzkaller.RIuxjO/526/file0 supports timestamps until 2038 (0x7fffffff)
==================================================================
BUG: KASAN: use-after-free in atomic_fetch_add include/asm-generic/atomic-instrumented.h:111 [inline]
BUG: KASAN: use-after-free in refcount_add include/linux/refcount.h:188 [inline]
BUG: KASAN: use-after-free in refcount_inc include/linux/refcount.h:228 [inline]
BUG: KASAN: use-after-free in get_task_struct include/linux/sched/task.h:113 [inline]
BUG: KASAN: use-after-free in kthread_stop+0x183/0x6ee kernel/kthread.c:554
Write of size 4 at addr ff11000042b71f20 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G      D           5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 atomic_fetch_add include/asm-generic/atomic-instrumented.h:111 [inline]
 refcount_add include/linux/refcount.h:188 [inline]
 refcount_inc include/linux/refcount.h:228 [inline]
 get_task_struct include/linux/sched/task.h:113 [inline]
 kthread_stop+0x183/0x6ee kernel/kthread.c:554
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 32 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0x0 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd4000001a36600 0000000300000003 ff1100006c9b4280
raw: 0000000000000000 0000000000040004 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_set include/asm-generic/atomic-instrumented.h:44 [inline]
BUG: KASAN: use-after-free in refcount_set include/linux/refcount.h:123 [inline]
BUG: KASAN: use-after-free in refcount_warn_saturate+0x19/0x1e1 lib/refcount.c:15
Write of size 4 at addr ff11000042b71f20 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D           5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 atomic_set include/asm-generic/atomic-instrumented.h:44 [inline]
 refcount_set include/linux/refcount.h:123 [inline]
 refcount_warn_saturate+0x19/0x1e1 lib/refcount.c:15
 refcount_add include/linux/refcount.h:191 [inline]
 refcount_inc include/linux/refcount.h:228 [inline]
 get_task_struct include/linux/sched/task.h:113 [inline]
 kthread_stop+0x42b/0x6ee kernel/kthread.c:554
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 32 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0x0 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd4000001a36600 0000000300000003 ff1100006c9b4280
raw: 0000000000000000 0000000000040004 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in arch_atomic_set arch/x86/include/asm/atomic.h:43 [inline]
BUG: KASAN: use-after-free in atomic_set include/asm-generic/atomic-instrumented.h:45 [inline]
BUG: KASAN: use-after-free in refcount_set include/linux/refcount.h:123 [inline]
BUG: KASAN: use-after-free in refcount_warn_saturate+0xb1/0x1e1 lib/refcount.c:15
Write of size 4 at addr ff11000042b71f20 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D           5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 arch_atomic_set arch/x86/include/asm/atomic.h:43 [inline]
 atomic_set include/asm-generic/atomic-instrumented.h:45 [inline]
 refcount_set include/linux/refcount.h:123 [inline]
 refcount_warn_saturate+0xb1/0x1e1 lib/refcount.c:15
 refcount_add include/linux/refcount.h:191 [inline]
 refcount_inc include/linux/refcount.h:228 [inline]
 get_task_struct include/linux/sched/task.h:113 [inline]
 kthread_stop+0x42b/0x6ee kernel/kthread.c:554
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 32 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0x0 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd4000001a36600 0000000300000003 ff1100006c9b4280
raw: 0000000000000000 0000000000040004 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
------------[ cut here ]------------
refcount_t: addition on 0; use-after-free.
WARNING: CPU: 1 PID: 296 at lib/refcount.c:25 refcount_warn_saturate+0x163/0x1e1 lib/refcount.c:25
Modules linked in:
CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D           5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
RIP: 0010:refcount_warn_saturate+0x163/0x1e1 lib/refcount.c:25
Code: f7 02 89 de bf 00 00 00 00 e8 65 df 63 ff 84 db 75 c0 e8 26 d2 63 ff c6 05 96 14 f7 02 01 48 c7 c7 80 18 da 83 e8 c7 8d 3d ff <0f> 0b eb a4 e8 0a d2 63 ff 0f b6 1d 79 14 f7 02 89 de bf 00 00 00
RSP: 0018:ff11000046dc7ca8 EFLAGS: 00010286
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000
RDX: ff11000066341f00 RSI: ffffffff812579e8 RDI: ffe21c0008db8f87
RBP: ff11000042b71f20 R08: 0000000000000001 R09: ff11000066341f00
R10: 0000000000000000 R11: ff1100006cf315ff R12: ff11000042b71f20
R13: ff11000069464390 R14: ff11000069466000 R15: dffffc0000000000
FS:  0000555556757480(0000) GS:ff1100006cf00000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007f949702c0f8 CR3: 0000000046dbc006 CR4: 0000000000761ee0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
PKRU: 55555554
Call Trace:
 refcount_add include/linux/refcount.h:191 [inline]
 refcount_inc include/linux/refcount.h:228 [inline]
 get_task_struct include/linux/sched/task.h:113 [inline]
 kthread_stop+0x42b/0x6ee kernel/kthread.c:554
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680
irq event stamp: 3064932
hardirqs last  enabled at (3064931): [<ffffffff836e0409>] __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:168 [inline]
hardirqs last  enabled at (3064931): [<ffffffff836e0409>] _raw_spin_unlock_irq+0x1f/0x29 kernel/locking/spinlock.c:199
hardirqs last disabled at (3064932): [<ffffffff836d25ba>] __schedule+0x382/0x179d kernel/sched/core.c:4017
softirqs last  enabled at (3064918): [<ffffffff83a00768>] __do_softirq+0x768/0x82b kernel/softirq.c:319
softirqs last disabled at (3064907): [<ffffffff8114242d>] invoke_softirq kernel/softirq.c:373 [inline]
softirqs last disabled at (3064907): [<ffffffff8114242d>] irq_exit+0xd2/0x157 kernel/softirq.c:413
---[ end trace 75ab55e212996fb3 ]---
==================================================================
BUG: KASAN: use-after-free in to_kthread kernel/kthread.c:75 [inline]
BUG: KASAN: use-after-free in kthread_stop+0x44c/0x6ee kernel/kthread.c:555
Read of size 4 at addr ff11000042b71f24 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 to_kthread kernel/kthread.c:75 [inline]
 kthread_stop+0x44c/0x6ee kernel/kthread.c:555
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 36 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in to_kthread kernel/kthread.c:76 [inline]
BUG: KASAN: use-after-free in kthread_stop+0x462/0x6ee kernel/kthread.c:555
Read of size 8 at addr ff11000042b72468 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 to_kthread kernel/kthread.c:76 [inline]
 kthread_stop+0x462/0x6ee kernel/kthread.c:555
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1384 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72300: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72380: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72400: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                          ^
 ff11000042b72480: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72500: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in set_bit include/asm-generic/bitops/instrumented-atomic.h:28 [inline]
BUG: KASAN: use-after-free in kthread_stop+0x261/0x6ee kernel/kthread.c:556
Write of size 8 at addr ff11000066033c00 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 set_bit include/asm-generic/bitops/instrumented-atomic.h:28 [inline]
 kthread_stop+0x261/0x6ee kernel/kthread.c:556
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 0 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                   ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in to_kthread kernel/kthread.c:75 [inline]
BUG: KASAN: use-after-free in kthread_unpark+0xf1/0x16d kernel/kthread.c:474
Read of size 4 at addr ff11000042b71f24 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 to_kthread kernel/kthread.c:75 [inline]
 kthread_unpark+0xf1/0x16d kernel/kthread.c:474
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 36 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in to_kthread kernel/kthread.c:76 [inline]
BUG: KASAN: use-after-free in kthread_unpark+0x107/0x16d kernel/kthread.c:474
Read of size 8 at addr ff11000042b72468 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 to_kthread kernel/kthread.c:76 [inline]
 kthread_unpark+0x107/0x16d kernel/kthread.c:474
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1384 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72300: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72380: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72400: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                          ^
 ff11000042b72480: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72500: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in test_bit include/asm-generic/bitops/instrumented-non-atomic.h:110 [inline]
BUG: KASAN: use-after-free in kthread_unpark+0x92/0x16d kernel/kthread.c:480
Read of size 8 at addr ff11000066033c00 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_read+0x10/0x11 mm/kasan/common.c:95
 test_bit include/asm-generic/bitops/instrumented-non-atomic.h:110 [inline]
 kthread_unpark+0x92/0x16d kernel/kthread.c:480
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 0 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                   ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in constant_test_bit arch/x86/include/asm/bitops.h:207 [inline]
BUG: KASAN: use-after-free in test_bit include/asm-generic/bitops/instrumented-non-atomic.h:111 [inline]
BUG: KASAN: use-after-free in kthread_unpark+0x114/0x16d kernel/kthread.c:480
Read of size 8 at addr ff11000066033c00 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 constant_test_bit arch/x86/include/asm/bitops.h:207 [inline]
 test_bit include/asm-generic/bitops/instrumented-non-atomic.h:111 [inline]
 kthread_unpark+0x114/0x16d kernel/kthread.c:480
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 0 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                   ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in clear_bit include/asm-generic/bitops/instrumented-atomic.h:41 [inline]
BUG: KASAN: use-after-free in kthread_unpark+0xd5/0x16d kernel/kthread.c:483
Write of size 8 at addr ff11000066033c00 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 clear_bit include/asm-generic/bitops/instrumented-atomic.h:41 [inline]
 kthread_unpark+0xd5/0x16d kernel/kthread.c:483
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 0 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                   ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:83 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x1d8/0x259 kernel/locking/spinlock_debug.c:112
Read of size 4 at addr ff11000042b72694 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:83 [inline]
 do_raw_spin_lock+0x1d8/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1940 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:84 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x1f6/0x259 kernel/locking/spinlock_debug.c:112
Read of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:84 [inline]
 do_raw_spin_lock+0x1f6/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:85 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x214/0x259 kernel/locking/spinlock_debug.c:112
Read of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:85 [inline]
 do_raw_spin_lock+0x214/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_try_cmpxchg include/asm-generic/atomic-instrumented.h:693 [inline]
BUG: KASAN: use-after-free in queued_spin_lock include/asm-generic/qspinlock.h:78 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x117/0x259 kernel/locking/spinlock_debug.c:113
Write of size 4 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 atomic_try_cmpxchg include/asm-generic/atomic-instrumented.h:693 [inline]
 queued_spin_lock include/asm-generic/qspinlock.h:78 [inline]
 do_raw_spin_lock+0x117/0x259 kernel/locking/spinlock_debug.c:113
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_after kernel/locking/spinlock_debug.c:91 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x245/0x259 kernel/locking/spinlock_debug.c:115
Write of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 debug_spin_lock_after kernel/locking/spinlock_debug.c:91 [inline]
 do_raw_spin_lock+0x245/0x259 kernel/locking/spinlock_debug.c:115
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:226 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_after kernel/locking/spinlock_debug.c:92 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x24f/0x259 kernel/locking/spinlock_debug.c:115
Write of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store8_noabort+0x13/0x14 mm/kasan/generic_report.c:140
 __write_once_size include/linux/compiler.h:226 [inline]
 debug_spin_lock_after kernel/locking/spinlock_debug.c:92 [inline]
 do_raw_spin_lock+0x24f/0x259 kernel/locking/spinlock_debug.c:115
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in try_to_wake_up+0x1c3/0xdee kernel/sched/core.c:2549
Read of size 8 at addr ff11000042b71f10 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 try_to_wake_up+0x1c3/0xdee kernel/sched/core.c:2549
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 16 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:97 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x174/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72694 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 debug_spin_unlock kernel/locking/spinlock_debug.c:97 [inline]
 do_raw_spin_unlock+0x174/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1940 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_read include/asm-generic/atomic-instrumented.h:26 [inline]
BUG: KASAN: use-after-free in queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x4c/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_read+0x10/0x11 mm/kasan/common.c:95
 atomic_read include/asm-generic/atomic-instrumented.h:26 [inline]
 queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
 do_raw_spin_unlock+0x4c/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in arch_atomic_read arch/x86/include/asm/atomic.h:31 [inline]
BUG: KASAN: use-after-free in atomic_read include/asm-generic/atomic-instrumented.h:27 [inline]
BUG: KASAN: use-after-free in queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x195/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 arch_atomic_read arch/x86/include/asm/atomic.h:31 [inline]
 atomic_read include/asm-generic/atomic-instrumented.h:27 [inline]
 queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
 do_raw_spin_unlock+0x195/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:99 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1b3/0x20b kernel/locking/spinlock_debug.c:138
Read of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 debug_spin_unlock kernel/locking/spinlock_debug.c:99 [inline]
 do_raw_spin_unlock+0x1b3/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:100 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1d1/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 debug_spin_unlock kernel/locking/spinlock_debug.c:100 [inline]
 do_raw_spin_unlock+0x1d1/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:226 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:102 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1ef/0x20b kernel/locking/spinlock_debug.c:138
Write of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store8_noabort+0x13/0x14 mm/kasan/generic_report.c:140
 __write_once_size include/linux/compiler.h:226 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:102 [inline]
 do_raw_spin_unlock+0x1ef/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:103 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1f9/0x20b kernel/locking/spinlock_debug.c:138
Write of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:103 [inline]
 do_raw_spin_unlock+0x1f9/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:223 [inline]
BUG: KASAN: use-after-free in queued_spin_unlock include/asm-generic/qspinlock.h:94 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x206/0x20b kernel/locking/spinlock_debug.c:139
Write of size 1 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store1_noabort+0x13/0x14 mm/kasan/generic_report.c:137
 __write_once_size include/linux/compiler.h:223 [inline]
 queued_spin_unlock include/asm-generic/qspinlock.h:94 [inline]
 do_raw_spin_unlock+0x206/0x20b kernel/locking/spinlock_debug.c:139
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_state+0xa/0xb kernel/sched/core.c:2669
 kthread_unpark+0xe7/0x16d kernel/kthread.c:487
 kthread_stop+0x26e/0x6ee kernel/kthread.c:557
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:83 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x1d8/0x259 kernel/locking/spinlock_debug.c:112
Read of size 4 at addr ff11000042b72694 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:83 [inline]
 do_raw_spin_lock+0x1d8/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1940 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:84 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x1f6/0x259 kernel/locking/spinlock_debug.c:112
Read of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:84 [inline]
 do_raw_spin_lock+0x1f6/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce00 0000000300000003 ff1100006c9b4280
raw: ff11000042b75d00 0000000080040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:85 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x214/0x259 kernel/locking/spinlock_debug.c:112
Read of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:85 [inline]
 do_raw_spin_lock+0x214/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_try_cmpxchg include/asm-generic/atomic-instrumented.h:693 [inline]
BUG: KASAN: use-after-free in queued_spin_lock include/asm-generic/qspinlock.h:78 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x117/0x259 kernel/locking/spinlock_debug.c:113
Write of size 4 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 atomic_try_cmpxchg include/asm-generic/atomic-instrumented.h:693 [inline]
 queued_spin_lock include/asm-generic/qspinlock.h:78 [inline]
 do_raw_spin_lock+0x117/0x259 kernel/locking/spinlock_debug.c:113
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_after kernel/locking/spinlock_debug.c:91 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x245/0x259 kernel/locking/spinlock_debug.c:115
Write of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 debug_spin_lock_after kernel/locking/spinlock_debug.c:91 [inline]
 do_raw_spin_lock+0x245/0x259 kernel/locking/spinlock_debug.c:115
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:226 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_after kernel/locking/spinlock_debug.c:92 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x24f/0x259 kernel/locking/spinlock_debug.c:115
Write of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store8_noabort+0x13/0x14 mm/kasan/generic_report.c:140
 __write_once_size include/linux/compiler.h:226 [inline]
 debug_spin_lock_after kernel/locking/spinlock_debug.c:92 [inline]
 do_raw_spin_lock+0x24f/0x259 kernel/locking/spinlock_debug.c:115
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:117 [inline]
 _raw_spin_lock_irqsave+0x44/0x4e kernel/locking/spinlock.c:159
 try_to_wake_up+0x8f/0xdee kernel/sched/core.c:2547
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in try_to_wake_up+0x1c3/0xdee kernel/sched/core.c:2549
Read of size 8 at addr ff11000042b71f10 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 try_to_wake_up+0x1c3/0xdee kernel/sched/core.c:2549
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 16 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:97 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x174/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72694 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 debug_spin_unlock kernel/locking/spinlock_debug.c:97 [inline]
 do_raw_spin_unlock+0x174/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1940 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_read include/asm-generic/atomic-instrumented.h:26 [inline]
BUG: KASAN: use-after-free in queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x4c/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_read+0x10/0x11 mm/kasan/common.c:95
 atomic_read include/asm-generic/atomic-instrumented.h:26 [inline]
 queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
 do_raw_spin_unlock+0x4c/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in arch_atomic_read arch/x86/include/asm/atomic.h:31 [inline]
BUG: KASAN: use-after-free in atomic_read include/asm-generic/atomic-instrumented.h:27 [inline]
BUG: KASAN: use-after-free in queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x195/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 arch_atomic_read arch/x86/include/asm/atomic.h:31 [inline]
 atomic_read include/asm-generic/atomic-instrumented.h:27 [inline]
 queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
 do_raw_spin_unlock+0x195/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:99 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1b3/0x20b kernel/locking/spinlock_debug.c:138
Read of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 debug_spin_unlock kernel/locking/spinlock_debug.c:99 [inline]
 do_raw_spin_unlock+0x1b3/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:100 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1d1/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 debug_spin_unlock kernel/locking/spinlock_debug.c:100 [inline]
 do_raw_spin_unlock+0x1d1/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:226 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:102 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1ef/0x20b kernel/locking/spinlock_debug.c:138
Write of size 8 at addr ff11000042b726a0 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store8_noabort+0x13/0x14 mm/kasan/generic_report.c:140
 __write_once_size include/linux/compiler.h:226 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:102 [inline]
 do_raw_spin_unlock+0x1ef/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1952 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:103 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1f9/0x20b kernel/locking/spinlock_debug.c:138
Write of size 4 at addr ff11000042b72698 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:103 [inline]
 do_raw_spin_unlock+0x1f9/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1944 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                            ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:223 [inline]
BUG: KASAN: use-after-free in queued_spin_unlock include/asm-generic/qspinlock.h:94 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x206/0x20b kernel/locking/spinlock_debug.c:139
Write of size 1 at addr ff11000042b72690 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store1_noabort+0x13/0x14 mm/kasan/generic_report.c:137
 __write_once_size include/linux/compiler.h:223 [inline]
 queued_spin_unlock include/asm-generic/qspinlock.h:94 [inline]
 do_raw_spin_unlock+0x206/0x20b kernel/locking/spinlock_debug.c:139
 __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:159 [inline]
 _raw_spin_unlock_irqrestore+0x1e/0x3d kernel/locking/spinlock.c:191
 try_to_wake_up+0xcb/0xdee kernel/sched/core.c:2641
 wake_up_process+0xf/0x10 kernel/sched/core.c:2663
 kthread_stop+0x276/0x6ee kernel/kthread.c:558
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1936 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                         ^
 ff11000042b72700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:83 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x1d8/0x259 kernel/locking/spinlock_debug.c:112
Read of size 4 at addr ff11000066033c74 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:83 [inline]
 do_raw_spin_lock+0x1d8/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irq include/linux/spinlock_api_smp.h:129 [inline]
 _raw_spin_lock_irq+0x41/0x47 kernel/locking/spinlock.c:167
 spin_lock_irq include/linux/spinlock.h:363 [inline]
 __wait_for_common kernel/sched/completion.c:103 [inline]
 wait_for_common+0x36/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 116 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                             ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:84 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x1f6/0x259 kernel/locking/spinlock_debug.c:112
Read of size 8 at addr ff11000066033c80 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:84 [inline]
 do_raw_spin_lock+0x1f6/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irq include/linux/spinlock_api_smp.h:129 [inline]
 _raw_spin_lock_irq+0x41/0x47 kernel/locking/spinlock.c:167
 spin_lock_irq include/linux/spinlock.h:363 [inline]
 __wait_for_common kernel/sched/completion.c:103 [inline]
 wait_for_common+0x36/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 128 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
 ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
                   ^
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033d80: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_before kernel/locking/spinlock_debug.c:85 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x214/0x259 kernel/locking/spinlock_debug.c:112
Read of size 4 at addr ff11000066033c78 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 debug_spin_lock_before kernel/locking/spinlock_debug.c:85 [inline]
 do_raw_spin_lock+0x214/0x259 kernel/locking/spinlock_debug.c:112
 __raw_spin_lock_irq include/linux/spinlock_api_smp.h:129 [inline]
 _raw_spin_lock_irq+0x41/0x47 kernel/locking/spinlock.c:167
 spin_lock_irq include/linux/spinlock.h:363 [inline]
 __wait_for_common kernel/sched/completion.c:103 [inline]
 wait_for_common+0x36/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 120 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                                ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_try_cmpxchg include/asm-generic/atomic-instrumented.h:693 [inline]
BUG: KASAN: use-after-free in queued_spin_lock include/asm-generic/qspinlock.h:78 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x117/0x259 kernel/locking/spinlock_debug.c:113
Write of size 4 at addr ff11000066033c70 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 atomic_try_cmpxchg include/asm-generic/atomic-instrumented.h:693 [inline]
 queued_spin_lock include/asm-generic/qspinlock.h:78 [inline]
 do_raw_spin_lock+0x117/0x259 kernel/locking/spinlock_debug.c:113
 __raw_spin_lock_irq include/linux/spinlock_api_smp.h:129 [inline]
 _raw_spin_lock_irq+0x41/0x47 kernel/locking/spinlock.c:167
 spin_lock_irq include/linux/spinlock.h:363 [inline]
 __wait_for_common kernel/sched/completion.c:103 [inline]
 wait_for_common+0x36/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 112 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                             ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_after kernel/locking/spinlock_debug.c:91 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x245/0x259 kernel/locking/spinlock_debug.c:115
Write of size 4 at addr ff11000066033c78 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 debug_spin_lock_after kernel/locking/spinlock_debug.c:91 [inline]
 do_raw_spin_lock+0x245/0x259 kernel/locking/spinlock_debug.c:115
 __raw_spin_lock_irq include/linux/spinlock_api_smp.h:129 [inline]
 _raw_spin_lock_irq+0x41/0x47 kernel/locking/spinlock.c:167
 spin_lock_irq include/linux/spinlock.h:363 [inline]
 __wait_for_common kernel/sched/completion.c:103 [inline]
 wait_for_common+0x36/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 120 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                                ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:226 [inline]
BUG: KASAN: use-after-free in debug_spin_lock_after kernel/locking/spinlock_debug.c:92 [inline]
BUG: KASAN: use-after-free in do_raw_spin_lock+0x24f/0x259 kernel/locking/spinlock_debug.c:115
Write of size 8 at addr ff11000066033c80 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store8_noabort+0x13/0x14 mm/kasan/generic_report.c:140
 __write_once_size include/linux/compiler.h:226 [inline]
 debug_spin_lock_after kernel/locking/spinlock_debug.c:92 [inline]
 do_raw_spin_lock+0x24f/0x259 kernel/locking/spinlock_debug.c:115
 __raw_spin_lock_irq include/linux/spinlock_api_smp.h:129 [inline]
 _raw_spin_lock_irq+0x41/0x47 kernel/locking/spinlock.c:167
 spin_lock_irq include/linux/spinlock.h:363 [inline]
 __wait_for_common kernel/sched/completion.c:103 [inline]
 wait_for_common+0x36/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 128 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
 ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
                   ^
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033d80: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: use-after-free in do_wait_for_common+0x14e/0x3de kernel/sched/completion.c:72
Read of size 4 at addr ff11000066033c68 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 do_wait_for_common+0x14e/0x3de kernel/sched/completion.c:72
 __wait_for_common kernel/sched/completion.c:104 [inline]
 wait_for_common+0x4b/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 104 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                          ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in do_wait_for_common+0x3d4/0x3de kernel/sched/completion.c:90
Read of size 4 at addr ff11000066033c68 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 do_wait_for_common+0x3d4/0x3de kernel/sched/completion.c:90
 __wait_for_common kernel/sched/completion.c:104 [inline]
 wait_for_common+0x4b/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 104 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                          ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:97 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x174/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000066033c74 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 debug_spin_unlock kernel/locking/spinlock_debug.c:97 [inline]
 do_raw_spin_unlock+0x174/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 116 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                             ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_read include/asm-generic/atomic-instrumented.h:26 [inline]
BUG: KASAN: use-after-free in queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x4c/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000066033c70 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_read+0x10/0x11 mm/kasan/common.c:95
 atomic_read include/asm-generic/atomic-instrumented.h:26 [inline]
 queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
 do_raw_spin_unlock+0x4c/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 112 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                             ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __read_once_size include/linux/compiler.h:199 [inline]
BUG: KASAN: use-after-free in arch_atomic_read arch/x86/include/asm/atomic.h:31 [inline]
BUG: KASAN: use-after-free in atomic_read include/asm-generic/atomic-instrumented.h:27 [inline]
BUG: KASAN: use-after-free in queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x195/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000066033c70 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 __read_once_size include/linux/compiler.h:199 [inline]
 arch_atomic_read arch/x86/include/asm/atomic.h:31 [inline]
 atomic_read include/asm-generic/atomic-instrumented.h:27 [inline]
 queued_spin_is_locked include/asm-generic/qspinlock.h:26 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:98 [inline]
 do_raw_spin_unlock+0x195/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 112 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                             ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:99 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1b3/0x20b kernel/locking/spinlock_debug.c:138
Read of size 8 at addr ff11000066033c80 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load8_noabort+0x13/0x14 mm/kasan/generic_report.c:135
 debug_spin_unlock kernel/locking/spinlock_debug.c:99 [inline]
 do_raw_spin_unlock+0x1b3/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 128 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
 ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
                   ^
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033d80: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:100 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1d1/0x20b kernel/locking/spinlock_debug.c:138
Read of size 4 at addr ff11000066033c78 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 debug_spin_unlock kernel/locking/spinlock_debug.c:100 [inline]
 do_raw_spin_unlock+0x1d1/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 120 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                                ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:226 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:102 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1ef/0x20b kernel/locking/spinlock_debug.c:138
Write of size 8 at addr ff11000066033c80 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store8_noabort+0x13/0x14 mm/kasan/generic_report.c:140
 __write_once_size include/linux/compiler.h:226 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:102 [inline]
 do_raw_spin_unlock+0x1ef/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 128 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
 ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
                   ^
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033d80: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in debug_spin_unlock kernel/locking/spinlock_debug.c:103 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x1f9/0x20b kernel/locking/spinlock_debug.c:138
Write of size 4 at addr ff11000066033c78 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 debug_spin_unlock kernel/locking/spinlock_debug.c:103 [inline]
 do_raw_spin_unlock+0x1f9/0x20b kernel/locking/spinlock_debug.c:138
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 120 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                                ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:223 [inline]
BUG: KASAN: use-after-free in queued_spin_unlock include/asm-generic/qspinlock.h:94 [inline]
BUG: KASAN: use-after-free in do_raw_spin_unlock+0x206/0x20b kernel/locking/spinlock_debug.c:139
Write of size 1 at addr ff11000066033c70 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store1_noabort+0x13/0x14 mm/kasan/generic_report.c:137
 __write_once_size include/linux/compiler.h:223 [inline]
 queued_spin_unlock include/asm-generic/qspinlock.h:94 [inline]
 do_raw_spin_unlock+0x206/0x20b kernel/locking/spinlock_debug.c:139
 __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:167 [inline]
 _raw_spin_unlock_irq+0x1a/0x29 kernel/locking/spinlock.c:199
 spin_unlock_irq include/linux/spinlock.h:388 [inline]
 __wait_for_common kernel/sched/completion.c:105 [inline]
 wait_for_common+0x56/0x60 kernel/sched/completion.c:115
 wait_for_completion+0x14/0x15 kernel/sched/completion.c:136
 kthread_stop+0x27f/0x6ee kernel/kthread.c:559
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 28256:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_kmalloc+0xb/0xc mm/kasan/common.c:529
 kmem_cache_alloc_trace+0x1ef/0x215 mm/slub.c:2813
 kmalloc include/linux/slab.h:555 [inline]
 kzalloc include/linux/slab.h:669 [inline]
 kthread+0x90/0x422 kernel/kthread.c:224
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kfree+0x122/0x28d mm/slub.c:3995
 free_kthread_struct+0x7c/0x96 kernel/kthread.c:91
 free_task+0x106/0x108 kernel/fork.c:475
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000066033c00
 which belongs to the cache kmalloc-192 of size 192
The buggy address is located 112 bytes inside of
 192-byte region [ff11000066033c00, ff11000066033cc0)
The buggy address belongs to the page:
page:ffd4000001980cc0 refcount:1 mapcount:0 mapping:ff1100006c802a00 index:0x0
flags: 0x100000000000200(slab)
raw: 0100000000000200 ffd40000015d6d80 0000000200000002 ff1100006c802a00
raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000066033b00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ff11000066033b80: 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc
>ff11000066033c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                                             ^
 ff11000066033c80: fb fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
 ff11000066033d00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in kthread_stop+0x46c/0x6ee kernel/kthread.c:560
Read of size 4 at addr ff11000042b72330 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_load4_noabort+0x13/0x14 mm/kasan/generic_report.c:134
 kthread_stop+0x46c/0x6ee kernel/kthread.c:560
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680
EXT4-fs (loop3): mounted filesystem without journal. Opts: ,errors=continue

ext4 filesystem being mounted at /syzkaller-testdir1134354286/syzkaller.dXRafX/606/file0 supports timestamps until 2038 (0x7fffffff)
Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 1072 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b72200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ff11000042b72300: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                     ^
 ff11000042b72380: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72400: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_fetch_sub include/asm-generic/atomic-instrumented.h:199 [inline]
BUG: KASAN: use-after-free in refcount_sub_and_test include/linux/refcount.h:253 [inline]
BUG: KASAN: use-after-free in refcount_dec_and_test include/linux/refcount.h:281 [inline]
BUG: KASAN: use-after-free in put_task_struct include/linux/sched/task.h:121 [inline]
BUG: KASAN: use-after-free in kthread_stop+0x2bb/0x6ee kernel/kthread.c:561
Write of size 4 at addr ff11000042b71f20 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 atomic_fetch_sub include/asm-generic/atomic-instrumented.h:199 [inline]
 refcount_sub_and_test include/linux/refcount.h:253 [inline]
 refcount_dec_and_test include/linux/refcount.h:281 [inline]
 put_task_struct include/linux/sched/task.h:121 [inline]
 kthread_stop+0x2bb/0x6ee kernel/kthread.c:561
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 32 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in atomic_set include/asm-generic/atomic-instrumented.h:44 [inline]
BUG: KASAN: use-after-free in refcount_set include/linux/refcount.h:123 [inline]
BUG: KASAN: use-after-free in refcount_warn_saturate+0x19/0x1e1 lib/refcount.c:15
Write of size 4 at addr ff11000042b71f20 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 check_memory_region_inline mm/kasan/generic.c:185 [inline]
 check_memory_region+0x1c4/0x1cb mm/kasan/generic.c:192
 __kasan_check_write+0x10/0x11 mm/kasan/common.c:101
 atomic_set include/asm-generic/atomic-instrumented.h:44 [inline]
 refcount_set include/linux/refcount.h:123 [inline]
 refcount_warn_saturate+0x19/0x1e1 lib/refcount.c:15
 refcount_sub_and_test include/linux/refcount.h:261 [inline]
 refcount_dec_and_test include/linux/refcount.h:281 [inline]
 put_task_struct include/linux/sched/task.h:121 [inline]
 kthread_stop+0x495/0x6ee kernel/kthread.c:561
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 32 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:225 [inline]
BUG: KASAN: use-after-free in arch_atomic_set arch/x86/include/asm/atomic.h:43 [inline]
BUG: KASAN: use-after-free in atomic_set include/asm-generic/atomic-instrumented.h:45 [inline]
BUG: KASAN: use-after-free in refcount_set include/linux/refcount.h:123 [inline]
BUG: KASAN: use-after-free in refcount_warn_saturate+0xb1/0x1e1 lib/refcount.c:15
Write of size 4 at addr ff11000042b71f20 by task syz-executor.0/296

CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x100/0x181 lib/dump_stack.c:118
 print_address_description+0x16/0x30d mm/kasan/report.c:374
 __kasan_report+0x1b8/0x1ff mm/kasan/report.c:506
 kasan_report+0xe/0x12 mm/kasan/common.c:641
 __asan_report_store4_noabort+0x13/0x14 mm/kasan/generic_report.c:139
 __write_once_size include/linux/compiler.h:225 [inline]
 arch_atomic_set arch/x86/include/asm/atomic.h:43 [inline]
 atomic_set include/asm-generic/atomic-instrumented.h:45 [inline]
 refcount_set include/linux/refcount.h:123 [inline]
 refcount_warn_saturate+0xb1/0x1e1 lib/refcount.c:15
 refcount_sub_and_test include/linux/refcount.h:261 [inline]
 refcount_dec_and_test include/linux/refcount.h:281 [inline]
 put_task_struct include/linux/sched/task.h:121 [inline]
 kthread_stop+0x495/0x6ee kernel/kthread.c:561
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680

Allocated by task 2:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 __kasan_kmalloc+0x95/0x9a mm/kasan/common.c:515
 kasan_slab_alloc+0x10/0x11 mm/kasan/common.c:523
 slab_post_alloc_hook mm/slab.h:584 [inline]
 slab_alloc_node mm/slub.c:2786 [inline]
 kmem_cache_alloc_node+0x189/0x2e5 mm/slub.c:2822
 alloc_task_struct_node kernel/fork.c:169 [inline]
 dup_task_struct kernel/fork.c:868 [inline]
 copy_process+0x1173/0x694c kernel/fork.c:1920
 _do_fork+0x199/0xa09 kernel/fork.c:2430
 kernel_thread+0xb4/0xe8 kernel/fork.c:2517
 create_kthread kernel/kthread.c:278 [inline]
 kthreadd+0x36d/0x601 kernel/kthread.c:596
 ret_from_fork+0x24/0x50 arch/x86/entry/entry_64.S:352

Freed by task 3999:
 save_stack+0x1c/0x74 mm/kasan/common.c:72
 set_track mm/kasan/common.c:80 [inline]
 kasan_set_free_info mm/kasan/common.c:337 [inline]
 __kasan_slab_free+0x12f/0x182 mm/kasan/common.c:476
 kasan_slab_free+0xa/0xb mm/kasan/common.c:485
 slab_free_hook mm/slub.c:1444 [inline]
 slab_free_freelist_hook+0x7e/0x163 mm/slub.c:1477
 slab_free mm/slub.c:3034 [inline]
 kmem_cache_free+0x9c/0x1ed mm/slub.c:3050
 free_task_struct kernel/fork.c:174 [inline]
 free_task+0xd6/0x108 kernel/fork.c:476
 __put_task_struct+0x39b/0x3a0 kernel/fork.c:751
 put_task_struct include/linux/sched/task.h:122 [inline]
 delayed_put_task_struct+0x2ff/0x31b kernel/exit.c:182
 rcu_do_batch kernel/rcu/tree.c:2186 [inline]
 rcu_core+0x938/0xf38 kernel/rcu/tree.c:2410
 rcu_core_si+0x5/0x6 kernel/rcu/tree.c:2419
 __do_softirq+0x2fa/0x82b kernel/softirq.c:292

The buggy address belongs to the object at ff11000042b71f00
 which belongs to the cache task_struct of size 7624
The buggy address is located 32 bytes inside of
 7624-byte region [ff11000042b71f00, ff11000042b73cc8)
The buggy address belongs to the page:
page:ffd40000010adc00 refcount:1 mapcount:0 mapping:ff1100006c9b4280 index:0xff11000042b75d00 compound_mapcount: 0
flags: 0x100000000010200(slab|head)
raw: 0100000000010200 ffd40000011bce08 ffd4000001b2d808 ff1100006c9b4280
raw: ff11000042b75d00 0000000000040002 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected

Memory state around the buggy address:
 ff11000042b71e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ff11000042b71e80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ff11000042b71f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
 ff11000042b71f80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ff11000042b72000: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
------------[ cut here ]------------
refcount_t: underflow; use-after-free.
WARNING: CPU: 1 PID: 296 at lib/refcount.c:28 refcount_warn_saturate+0x19b/0x1e1 lib/refcount.c:28
Modules linked in:
CPU: 1 PID: 296 Comm: syz-executor.0 Tainted: G    B D W         5.6.1 #6
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
RIP: 0010:refcount_warn_saturate+0x19b/0x1e1 lib/refcount.c:28
Code: f7 02 89 de bf 00 00 00 00 e8 2d df 63 ff 84 db 75 88 e8 ee d1 63 ff c6 05 5d 14 f7 02 01 48 c7 c7 e0 18 da 83 e8 8f 8d 3d ff <0f> 0b e9 69 ff ff ff e8 cf d1 63 ff 0f b6 1d 3c 14 f7 02 89 de bf
RSP: 0018:ff11000046dc7ca8 EFLAGS: 00010286
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000
RDX: ff11000066341f00 RSI: ffffffff812579e8 RDI: ffe21c0008db8f87
RBP: ff11000042b71f20 R08: 0000000000000001 R09: ff11000066341f00
R10: 0000000000000000 R11: ff1100006cf315ff R12: ff11000042b71f20
R13: 000000000000000b R14: ff11000069466000 R15: dffffc0000000000
FS:  0000555556757480(0000) GS:ff1100006cf00000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007f949702c0f8 CR3: 0000000046dbc006 CR4: 0000000000761ee0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
PKRU: 55555554
Call Trace:
 refcount_sub_and_test include/linux/refcount.h:261 [inline]
 refcount_dec_and_test include/linux/refcount.h:281 [inline]
 put_task_struct include/linux/sched/task.h:121 [inline]
 kthread_stop+0x495/0x6ee kernel/kthread.c:561
 ext4_put_super+0xdc7/0x1128 fs/ext4/super.c:1101
 generic_shutdown_super+0x142/0x38f fs/super.c:464
 kill_block_super+0x94/0xef fs/super.c:1444
 deactivate_locked_super+0x96/0xe9 fs/super.c:335
 deactivate_super+0x17f/0x186 fs/super.c:366
 cleanup_mnt+0x25a/0x315 fs/namespace.c:1102
 __cleanup_mnt+0x12/0x14 fs/namespace.c:1109
 task_work_run+0x167/0x1bf kernel/task_work.c:113
 tracehook_notify_resume include/linux/tracehook.h:188 [inline]
 exit_to_usermode_loop arch/x86/entry/common.c:164 [inline]
 prepare_exit_to_usermode+0x57f/0x5ea arch/x86/entry/common.c:195
 syscall_return_slowpath arch/x86/entry/common.c:278 [inline]
 do_syscall_64+0x15f/0x202 arch/x86/entry/common.c:304
 entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x7f90f4a9f74b
Code: b0 ff ff ff f7 d8 64 89 01 48 83 c8 ff c3 90 f3 0f 1e fa 31 f6 e9 05 00 00 00 0f 1f 44 00 00 f3 0f 1e fa b8 a6 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 c7 c2 b0 ff ff ff f7 d8
RSP: 002b:00007ffc338df4f8 EFLAGS: 00000246 ORIG_RAX: 00000000000000a6
RAX: 0000000000000000 RBX: 0000000000000000 RCX: 00007f90f4a9f74b
RDX: 00007f90f4a37280 RSI: 000000000000000a RDI: 00007ffc338df5b0
RBP: 00007ffc338df5b0 R08: 0000000000000000 R09: 00007ffc338df380
R10: 00005555567588b3 R11: 0000000000000246 R12: 00007f90f4afe312
R13: 00007ffc338e0690 R14: 0000555556758850 R15: 00007ffc338e0680
irq event stamp: 3064932
hardirqs last  enabled at (3064931): [<ffffffff836e0409>] __raw_spin_unlock_irq include/linux/spinlock_api_smp.h:168 [inline]
hardirqs last  enabled at (3064931): [<ffffffff836e0409>] _raw_spin_unlock_irq+0x1f/0x29 kernel/locking/spinlock.c:199
hardirqs last disabled at (3064932): [<ffffffff836d25ba>] __schedule+0x382/0x179d kernel/sched/core.c:4017
softirqs last  enabled at (3064918): [<ffffffff83a00768>] __do_softirq+0x768/0x82b kernel/softirq.c:319
softirqs last disabled at (3064907): [<ffffffff8114242d>] invoke_softirq kernel/softirq.c:373 [inline]
softirqs last disabled at (3064907): [<ffffffff8114242d>] irq_exit+0xd2/0x157 kernel/softirq.c:413
---[ end trace 75ab55e212996fb4 ]---
 loop6: p2 p3 p7
kmemleak: 1 new suspected memory leaks (see /sys/kernel/debug/kmemleak)
kmemleak: 1 new suspected memory leaks (see /sys/kernel/debug/kmemleak)
